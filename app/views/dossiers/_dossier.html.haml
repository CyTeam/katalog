%tr{:class => "dossier #{cycle('odd', 'even')}", :id => "dossier-#{dossier.id}"}
  - cache dossier do
    %td= dossier.signature
    %td
      %span.title= link_to dossier.title, dossier, {'data-href-container' => 'tr'}
      - unless local_assigns[:report] or local_assigns[:year_report]
        %br/
        %span.keywords
          = dossier.keywords.join(', ')
    - if local_assigns[:report]
      %td= dossier.first_document_year
      %td= dossier.container_types_shortcut.join(', ')
      %td= dossier.locations_shortcut.join(', ')
      %td= dossier.keywords.join(', ')
    - elsif local_assigns[:year_report]
      %td= dossier.first_document_year
      - dossier.years_counts.each do |count|
        %td.year= number_with_delimiter count[:count]
    - else
      %td.document_count.availability
        = number_with_delimiter(dossier.document_count)
        = availability_notes(dossier) unless local_assigns[:report]
      %td.action-links
        - if user_signed_in?
        = link_to image_tag('icons/edit.png', :title => t('tooltips.dossiers.edit')), edit_dossier_path(dossier)
        = link_to image_tag('icons/delete.png', :title => t('tooltips.dossiers.edit')), dossier, :confirm => t_confirm_delete(dossier), :remote => true, :method => :delete
